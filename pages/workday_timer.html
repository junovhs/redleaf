<!DOCTYPE html><html><head><base href=".">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultra Sleek Workday Timer</title>
<script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer=""></script>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

<style>
  :root {
    --gradient-start: #2563eb;
    --gradient-end: #3b82f6;
  }

  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    min-height: 100vh;
  }

  .timer-card {
    background: white;
    border-radius: 1.5rem;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }

  .timer-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
  }

  .countdown {
    background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    -webkit-background-clip: text;
    color: transparent;
    font-size: 3.5rem;
    font-weight: 600;
    text-align: center;
  }

  .input-group {
    position: relative;
    margin-bottom: 1.5rem;
  }

  .time-input-group {
    display: flex;
    align-items: center;
    border: 2px solid #e2e8f0;
    border-radius: 0.75rem;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .time-input-group:focus-within {
    border-color: var(--gradient-start);
    box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
  }

  .time-input-segment {
    width: 50%;
    padding: 0.75rem 0.5rem;
    text-align: center;
    border: none;
    outline: none;
    background: transparent;
  }

  .time-input-segment:first-child {
    border-right: 2px solid #e2e8f0;
  }

  .time-input-segment::placeholder {
    color: #94a3b8;
  }

  .time-separator {
    color: #94a3b8;
    padding: 0 0.25rem;
    user-select: none;
  }

  .start-btn {
    background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    border-radius: 0.75rem;
    color: white;
    font-weight: 500;
    padding: 1rem 2rem;
    transition: all 0.3s ease;
  }

  .start-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 5px 15px rgba(37,99,235,0.3);
  }

  @keyframes pulse-border {
    0% { border-color: var(--gradient-start); }
    50% { border-color: var(--gradient-end); }
    100% { border-color: var(--gradient-start); }
  }

  .alert {
    animation: pulse-border 2s infinite;
  }
</style>
</head>

<body class="p-4 md:p-8" x-data="timerApp()">
  <div class="max-w-2xl mx-auto">
    <div class="timer-card p-6 md:p-8">
      <h1 class="text-2xl md:text-3xl font-semibold text-gray-800 mb-6 text-center">Workday Timer</h1>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="input-group">
          <label class="block text-sm font-medium text-gray-700 mb-2 text-center">Workday Length</label>
          <div class="time-input-group">
            <input type="text" x-model="workdayHours" @input="validateHours($event, 'workdayHours')" placeholder="HH" maxlength="2" class="time-input-segment">
            <input type="text" x-model="workdayMinutes" @input="validateMinutes($event, 'workdayMinutes')" placeholder="MM" maxlength="2" class="time-input-segment">
          </div>
        </div>
        
        <div class="input-group">
          <label class="block text-sm font-medium text-gray-700 mb-2">Break Duration</label>
          <div class="time-input-group">
            <input type="text" x-model="breakHours" @input="validateHours($event, 'breakHours')" placeholder="HH" maxlength="2" class="time-input-segment">
            <input type="text" x-model="breakMinutes" @input="validateMinutes($event, 'breakMinutes')" placeholder="MM" maxlength="2" class="time-input-segment">
          </div>
        </div>
        
        <div class="input-group">
          <label class="block text-sm font-medium text-gray-700 mb-2">Time Already Worked</label>
          <div class="time-input-group">
            <input type="text" x-model="workedHours" @input="validateHours($event, 'workedHours')" placeholder="HH" maxlength="2" class="time-input-segment">
            <input type="text" x-model="workedMinutes" @input="validateMinutes($event, 'workedMinutes')" placeholder="MM" maxlength="2" class="time-input-segment">
          </div>
        </div>
      </div>

      <div class="my-8">
        <div class="countdown" :class="{ 'alert': isNearingEnd }">
          <span x-text="formatTime(remainingTime)"></span>
        </div>
        <p class="text-center text-gray-600 mt-2">
          End Time: <span x-text="calculateEndTime()"></span>
        </p>
      </div>

      <div class="flex justify-center">
        <button @click="startTimer()" class="start-btn animate__animated" :class="{ 'animate__pulse': isRunning }" x-text="isRunning ? 'Restart Timer' : 'Start Timer'">
        </button>
      </div>

      <div class="mt-8 pt-6 border-t border-gray-200">
        <div class="input-group">
          <label class="block text-sm font-medium text-gray-700 mb-2">What time will it be</label>
          <div class="flex items-center gap-4">
            <div class="time-input-group flex-1">
              <input type="text" x-model="futureHours" @input="validateHours($event, 'futureHours')" placeholder="HH" maxlength="2" class="time-input-segment">
              <input type="text" x-model="futureMinutes" @input="validateMinutes($event, 'futureMinutes')" placeholder="MM" maxlength="2" class="time-input-segment">
            </div>
            <span class="text-gray-600">from now</span>
            <button @click="calculateFutureTime()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
              Calculate
            </button>
          </div>
          <p class="mt-2 text-center text-gray-600" x-show="futureTimeResult">
            It will be: <span x-text="futureTimeResult" class="font-semibold"></span>
          </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    function timerApp() {
      return {
        workdayHours: '',
        workdayMinutes: '',
        breakHours: '',
        breakMinutes: '',
        workedHours: '',
        workedMinutes: '',
        futureHours: '',
        futureMinutes: '',
        futureTimeResult: '',
        remainingTime: 0,
        isRunning: false,
        timerInterval: null,
        isNearingEnd: false,

        init() {
          this.loadFromLocalStorage();
          if (Notification.permission !== 'granted') {
            Notification.requestPermission();
          }
        },

        validateHours(event, field) {
          let value = event.target.value.replace(/[^\d]/g, '');
          if (value > 23) value = '23';
          this[field] = value;
          this.updateTimeString();
        },

        validateMinutes(event, field) {
          let value = event.target.value.replace(/[^\d]/g, '');
          if (value > 59) value = '59';
          this[field] = value;
          this.updateTimeString();
        },

        setFutureAsMain() {
          if (this.futureHours || this.futureMinutes) {
            // Convert future time to seconds
            const futureSeconds = this.timeToSeconds(this.futureHours, this.futureMinutes);
            
            // Clear break and worked time
            this.breakHours = '0';
            this.breakMinutes = '0';
            this.workedHours = '0';
            this.workedMinutes = '0';
            
            // Set workday time to match future time
            const hours = Math.floor(futureSeconds / 3600);
            const minutes = Math.floor((futureSeconds % 3600) / 60);
            
            this.workdayHours = hours.toString();
            this.workdayMinutes = minutes.toString();
            
            // Start the timer automatically
            this.startTimer();
            
            // Clear future time inputs
            this.futureHours = '';
            this.futureMinutes = '';
            this.futureTimeResult = '';
          }
        },

        updateTimeString() {
          this.workdayLength = `${this.workdayHours.padStart(2, '0')}:${this.workdayMinutes.padStart(2, '0')}`;
          this.breakDuration = `${this.breakHours.padStart(2, '0')}:${this.breakMinutes.padStart(2, '0')}`;
          this.timeWorked = `${this.workedHours.padStart(2, '0')}:${this.workedMinutes.padStart(2, '0')}`;
        },

        timeToSeconds(hours, minutes) {
          return (parseInt(hours || 0) * 3600) + (parseInt(minutes || 0) * 60);
        },

        formatTime(seconds) {
          if (!seconds) return '00:00:00';
          const h = Math.floor(seconds / 3600);
          const m = Math.floor((seconds % 3600) / 60);
          const s = seconds % 60;
          return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        },

        calculateEndTime() {
          if (!this.remainingTime) return '--:--';
          const now = new Date();
          const end = new Date(now.getTime() + (this.remainingTime * 1000));
          return end.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        },

        calculateFutureTime() {
          this.setFutureAsMain();
        },

        startTimer() {
          clearInterval(this.timerInterval);
          
          const workdaySeconds = this.timeToSeconds(this.workdayHours, this.workdayMinutes);
          const breakSeconds = this.timeToSeconds(this.breakHours, this.breakMinutes);
          const workedSeconds = this.timeToSeconds(this.workedHours, this.workedMinutes);
          
          // Changed calculation to ADD break time since breaks extend the workday
          this.remainingTime = Math.max(0, workdaySeconds + breakSeconds - workedSeconds);
          this.isRunning = true;
          this.isNearingEnd = false;
          
          this.saveToLocalStorage();

          this.timerInterval = setInterval(() => {
            if (this.remainingTime > 0) {
              this.remainingTime--;
              if (this.remainingTime <= 300) {
                this.isNearingEnd = true;
              }
            } else {
              this.isRunning = false;
              clearInterval(this.timerInterval);
              this.showNotification();
            }
          }, 1000);
        },

        showNotification() {
          if ('Notification' in window && Notification.permission === 'granted') {
            new Notification('Workday Complete!', {
              body: 'Your scheduled work time has ended.',
              icon: 'https://example.com/icon.png'
            });
          }
        },

        saveToLocalStorage() {
          localStorage.setItem('timerSettings', JSON.stringify({
            workdayHours: this.workdayHours,
            workdayMinutes: this.workdayMinutes,
            breakHours: this.breakHours,
            breakMinutes: this.breakMinutes,
            workedHours: this.workedHours,
            workedMinutes: this.workedMinutes
          }));
        },

        loadFromLocalStorage() {
          const saved = localStorage.getItem('timerSettings');
          if (saved) {
            const settings = JSON.parse(saved);
            Object.assign(this, settings);
            this.updateTimeString();
          }
        }
      };
    }
  </script>
</body></html>
